<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <title>GitHub Enhancer</title>
    <style>
        body {
            font-family: sans-serif;
            background: #f6f8fa;
            color: #24292e;
            padding: 2em;
            max-width: 700px;
            margin: auto;
        }
        h1 {
            font-size: 2em;
        }
        .bookmarklet {
            display: inline-block;
            background: #2ea44f;
            color: white;
            padding: 0.6em 1em;
            margin: 1em 0 0.5em 0;
            border-radius: 6px;
            text-decoration: none;
            font-weight: bold;
        }
        .bookmarklet:hover {
            background: #22863a;
        }
        .report-link {
            margin-top: -0.5em;
            font-size: 0.9em;
        }
        .report-link a {
            color: #d73a49;
            text-decoration: underline;
        }
        ul {
            margin-top: 1em;
        }
    </style>
    <script src="//code.tidio.co/hpaso8rvozo8hlbrmen0uneggvpq3zhe.js" async></script>
</head>
<body>
    <h1>ðŸš€ Enhance Your GitHub Experience</h1>

    <p>
        <a class="bookmarklet" href="javascript:(function() {
          const settingsDialogId = 'github-enhancer-settings-dialog';
          let settingsDialog = document.getElementById(settingsDialogId);
          if (settingsDialog) {
            settingsDialog.style.display = 'block';
            return;
          }
          settingsDialog = document.createElement('div');
          settingsDialog.id = settingsDialogId;
          settingsDialog.style.position = 'fixed';
          settingsDialog.style.top = '50%';
          settingsDialog.style.left = '50%';
          settingsDialog.style.transform = 'translate(-50%, -50%)';
          settingsDialog.style.backgroundColor = '#f6f8fa';
          settingsDialog.style.color = '#24292e';
          settingsDialog.style.padding = '20px';
          settingsDialog.style.border = '1px solid #d1d5da';
          settingsDialog.style.borderRadius = '6px';
          settingsDialog.style.zIndex = '1000';
          settingsDialog.style.boxShadow = '0 1px 3px rgba(0, 0, 0, 0.12), 0 1px 2px rgba(0, 0, 0, 0.24)';
          settingsDialog.style.display = 'block';
          settingsDialog.style.fontFamily = '-apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;';
          settingsDialog.style.fontSize = '14px';
          const titleContainer = document.createElement('div');
          titleContainer.style.display = 'flex';
          titleContainer.style.justifyContent = 'space-between';
          titleContainer.style.alignItems = 'center';
          titleContainer.style.marginBottom = '15px';
          const title = document.createElement('h3');
          title.textContent = 'âš™ï¸ GitHub Enhancer Settings';
          title.style.fontWeight = '600';
          titleContainer.appendChild(title);
          const version = document.createElement('span');
          version.textContent = 'v0.1';
          version.style.fontSize = '12px';
          version.style.color = '#586069';
          titleContainer.appendChild(version);
          settingsDialog.appendChild(titleContainer);
          const extensionButton = document.createElement('button');
          extensionButton.textContent = 'Try our browser extension';
          extensionButton.style.position = 'absolute';
          extensionButton.style.top = '10px';
          extensionButton.style.right = '10px';
          extensionButton.style.padding = '8px 12px';
          extensionButton.style.backgroundColor = '#2da44e';
          extensionButton.style.color = 'white';
          extensionButton.style.border = '1px solid rgba(27, 31, 35, 0.15)';
          extensionButton.style.borderRadius = '6px';
          extensionButton.style.cursor = 'pointer';
          extensionButton.style.fontSize = '14px';
          extensionButton.addEventListener('click', function() {
            alert('Sorry this is coming soon');
          });
          settingsDialog.appendChild(extensionButton);
          const featuresConfig = [
            { name: 'Dark mode', handler: toggleDarkMode },
            { name: 'Inline file sizes', handler: null, comingSoon: true },
            { name: 'Copy branch name buttons', handler: addCopyBranchButtons },
            { name: 'Keyboard shortcuts', handler: null, comingSoon: true },
            { name: 'Auto-collapse outdated diffs', handler: collapseOutdatedDiffs },
            { name: 'One-click clone', handler: addOneClickClone },
            { name: 'TODO/FIXME highlighting', handler: highlightTodosFixmes },
            { name: 'Enhanced issue templates', handler: null, comingSoon: true },
            { name: 'Improved search filters', handler: null, comingSoon: true }
          ];
          const checkboxes = {};
          featuresConfig.forEach(featureConfig => {
            const label = document.createElement('label');
            label.style.display = 'block';
            label.style.marginBottom = '8px';
            const checkbox = document.createElement('input');
            checkbox.type = 'checkbox';
            checkbox.style.marginRight = '8px';
            checkbox.style.verticalAlign = 'middle';
            checkbox.disabled = featureConfig.comingSoon;
            label.appendChild(checkbox);
            label.appendChild(document.createTextNode(featureConfig.name));
            if (featureConfig.comingSoon) {
              const comingSoonText = document.createElement('span');
              comingSoonText.textContent = ' - COMING SOON WITH BROWSER EXTENSION';
              comingSoonText.style.fontWeight = 'bold';
              label.appendChild(comingSoonText);
            }
            settingsDialog.appendChild(label);
            checkboxes[featureConfig.name] = checkbox;
          });
          const buttonContainer = document.createElement('div');
          buttonContainer.style.marginTop = '20px';
          buttonContainer.style.display = 'flex';
          buttonContainer.style.justifyContent = 'flex-end';
          const closeButton = document.createElement('button');
          closeButton.textContent = 'Close';
          closeButton.style.padding = '8px 15px';
          closeButton.style.marginLeft = '10px';
          closeButton.style.backgroundColor = '#f6f8fa';
          closeButton.style.color = '#24292e';
          closeButton.style.border = '1px solid #d1d5da';
          closeButton.style.borderRadius = '6px';
          closeButton.style.cursor = 'pointer';
          closeButton.addEventListener('click', function() {
            settingsDialog.style.display = 'none';
          });
          buttonContainer.appendChild(closeButton);
          const saveButton = document.createElement('button');
          saveButton.textContent = 'Save Changes';
          saveButton.style.padding = '8px 15px';
          saveButton.style.marginLeft = '10px';
          saveButton.style.backgroundColor = '#2da44e';
          saveButton.style.color = 'white';
          saveButton.style.border = '1px solid rgba(27, 31, 35, 0.15)';
          saveButton.style.borderRadius = '6px';
          saveButton.style.cursor = 'pointer';
          saveButton.addEventListener('click', function() {
            settingsDialog.style.display = 'none';
            featuresConfig.forEach(featureConfig => {
              if (checkboxes[featureConfig.name].checked && featureConfig.handler) {
                featureConfig.handler(checkboxes[featureConfig.name].checked);
              } else if (checkboxes[featureConfig.name].checked && featureConfig.comingSoon) {
                alert(`"${featureConfig.name}" is coming soon with the browser extension!`);
              }
            });
          });
          buttonContainer.appendChild(saveButton);
          const aboutButton = document.createElement('button');
          aboutButton.textContent = 'About';
          aboutButton.style.padding = '8px 15px';
          aboutButton.style.marginLeft = '10px';
          aboutButton.style.backgroundColor = '#f6f8fa';
          aboutButton.style.color = '#24292e';
          aboutButton.style.border = '1px solid #d1d5da';
          aboutButton.style.borderRadius = '6px';
          aboutButton.style.cursor = 'pointer';
          aboutButton.style.display = 'block';
          aboutButton.style.marginTop = '15px';
          aboutButton.style.width = '100%';
          aboutButton.style.textAlign = 'center';
          aboutButton.addEventListener('click', function() {
            window.open('https://betterfeatures.github.io/bookmarkletinfo.txt', '_blank');
          });
          settingsDialog.appendChild(aboutButton);
          settingsDialog.appendChild(buttonContainer);
          document.body.appendChild(settingsDialog);

          function toggleDarkMode(enable) {
            document.body.classList.toggle('github-enhancer-dark', enable);
            const styleId = 'github-enhancer-dark-mode-style';
            let styleElement = document.getElementById(styleId);

            if (enable && !styleElement) {
              styleElement = document.createElement('style');
              styleElement.id = styleId;
              styleElement.textContent = `
                body.github-enhancer-dark {
                  background-color: #0d1117 !important;
                  color: #c9d1d9 !important;
                }
                .file-header, .blob-wrapper, .js-blob-code-inner, .markdown-body, .timeline-item, .comment-body {
                  background-color: #161b22 !important;
                  color: #c9d1d9 !important;
                }
                a {
                  color: #58a6ff !important;
                }
                .btn {
                  color: #c9d1d9 !important;
                  background-color: #21262d !important;
                  border-color: #30363d !important;
                }
              `;
              document.head.appendChild(styleElement);
            } else if (!enable && styleElement) {
              styleElement.remove();
            }
          }

          function addCopyBranchButtons() {
            const prTitle = document.querySelector('.gh-header-title');
            if (prTitle) {
              const branchLink = prTitle.querySelector('a[href*="/compare/"]');
              if (branchLink) {
                const branchName = branchLink.textContent.split('...')[1]?.trim();
                if (branchName && !document.querySelector('.copy-branch-button')) {
                  const copyButton = document.createElement('button');
                  copyButton.textContent = 'Copy Branch Name';
                  copyButton.classList.add('btn', 'btn-sm', 'copy-branch-button');
                  copyButton.style.marginLeft = '10px';
                  copyButton.addEventListener('click', () => {
                    navigator.clipboard.writeText(branchName).then(() => {
                      alert(`Branch name "${branchName}" copied to clipboard!`);
                    }).catch(err => {
                      console.error('Failed to copy: ', err);
                      alert('Failed to copy branch name.');
                    });
                  });
                  prTitle.appendChild(copyButton);
                }
              }
            }
          }

          function collapseOutdatedDiffs() {
            const collapseButtons = document.querySelectorAll('.diff-progressive-disclosure details[open]');
            collapseButtons.forEach(button => {
              if (button.querySelector('summary[aria-label*="outdated"]')) {
                button.removeAttribute('open');
              }
            });
          }

          function addOneClickClone() {
            const cloneButton = document.querySelector('.js-clone-https');
            if (cloneButton && !document.querySelector('.one-click-clone-ssh') && !document.querySelector('.one-click-clone-https-ssh')) {
              const repoUrlElement = document.querySelector('.js-clone-url');
              if (repoUrlElement) {
                const httpsUrl = repoUrlElement.value;
                const sshUrl = httpsUrl.replace(/^https/, 'git').replace(/\.com\//, '.com:');
                const createCloneButton = (text, url) => {
                  const btn = document.createElement('button');
                  btn.textContent = text;
                  btn.classList.add('btn', 'ml-2', 'one-click-clone-button');
                  btn.addEventListener('click', () => {
                    navigator.clipboard.writeText(url).then(() => {
                      alert(`"${text.replace('Clone ', '')}" URL copied to clipboard!`);
                    }).catch(err => {
                      console.error('Failed to copy: ', err);
                      alert(`Failed to copy "${text.replace('Clone ', '')}" URL.`);
                    });
                  });
                  return btn;
                };
                const httpsSshContainer = document.createElement('div');
                httpsSshContainer.classList.add('one-click-clone-https-ssh');
                httpsSshContainer.style.display = 'flex';
                httpsSshContainer.style.marginTop = '5px';
                httpsSshContainer.appendChild(createCloneButton('Clone HTTPS', httpsUrl));
                httpsSshContainer.appendChild(createCloneButton('Clone SSH', sshUrl));
                cloneButton.parentNode.insertBefore(httpsSshContainer, cloneButton.nextSibling);
                cloneButton.style.display = 'none';
              }
            }
          }

          function highlightTodosFixmes() {
            const codeBlocks = document.querySelectorAll('.blob-code-inner');
            codeBlocks.forEach(codeBlock => {
              const regex = /(TODO|FIXME)([:\s]+)(.*)/gi;
              codeBlock.innerHTML = codeBlock.innerHTML.replace(regex, (match, keyword, separator, text) => {
                const color = keyword.toUpperCase() === 'TODO' ? 'orange' : 'red';
                return `<span style="background-color:${color}; color:white; font-weight:bold; padding: 0.1em 0.3em; border-radius: 3px;">${keyword.toUpperCase()}</span>${separator}<span style="font-style: italic;">${text.trim()}</span>`;
              });
            });
          }

        })();">GitHub Enhancer</a>
    </p>

    <p class="report-link">
        <a href="report.html">Report Error</a>
    </p>

    <p>Then, navigate to GitHub and click the bookmark to activate new features!</p>

    <h2>âœ¨ Features</h2>
    <ul>
        <li>Dark mode toggle for better night-time coding</li>
        <li>Inline file size indicators in repositories</li>
        <li>Copy branch name buttons on pull requests</li>
        <li>Keyboard shortcuts for faster navigation</li>
        <li>Auto-collapse outdated diffs in pull requests</li>
        <li>One-click cloning with SSH or HTTPS</li>
        <li>Highlighting of TODOs and FIXMEs in code</li>
        <li>Enhanced issue templates with pre-filled labels</li>
        <li>Quick access to CI/CD status badges</li>
        <li>Improved search filters for repositories and issues</li>
    </ul>

    <p>These features are inspired by community feedback and popular GitHub enhancements.</p>
</body>
</html>
